{% extends "base.html" %}
{% block title %}Dashboard - IoT Portal{% endblock %}

{% block content %}
<section class="section">
  <div class="container">
    <!-- Tarjetas de Métricas -->
    <div class="columns is-multiline">
      {% for stat in stats %}
        <div class="column is-3">
          <div class="card-stats animate__animated animate__fadeInUp {{ stat.colorClass }}">
            <div class="title is-5">{{ stat.title }}</div>
            <div class="subtitle is-3">{{ stat.value }}</div>
            <div class="is-small">{{ stat.subtitle }}</div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Área de Gráficas -->
    <div class="columns">
      <div class="column is-6">
        <!-- Gráfica de Pastel: Distribución de Estados -->
        <div class="card animate__animated animate__fadeInUp">
          <header class="card-header">
            <p class="card-header-title">Device Status Distribution</p>
          </header>
          <div class="card-content" style="height: 300px;">
            <canvas id="statusChart"></canvas>
          </div>
        </div>
      </div>
      <div class="column is-6">
        <!-- Gráfica de Barras: Ejemplo Uptime -->
        <div class="card animate__animated animate__fadeInUp">
          <header class="card-header">
            <p class="card-header-title">Device Uptime (Hours)</p>
          </header>
          <div class="card-content" style="height: 300px;">
            <canvas id="uptimeChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Sección de Dispositivos con diseño de tarjeta increíble -->
    <div class="mt-5">
      <h2 class="title is-4">Devices</h2>
      <div class="columns is-multiline">
        {% for device in devices %}
          <div class="column is-3">
            <div class="device-card animate__animated animate__fadeInUp">
              <div class="card-header">
                <span class="device-title">{{ device.name }}</span>
                <span class="device-menu">
                  <i class="fas fa-ellipsis-h"></i>
                </span>
              </div>
              <div class="device-icon-wrapper">
                <div class="device-icon-circle">
                  <img src="{{ device.iconUrl }}" alt="Device Icon" class="device-icon">
                </div>
              </div>
              <div class="device-info">
                <div class="device-row">
                  <span>Power</span>
                  <label class="switch">
                    <input type="checkbox" {% if device.device_status == 1 %}checked{% endif %}>
                    <span class="slider round"></span>
                  </label>
                </div>
                <div class="device-row">
                  <span>Thermal</span>
                  <strong>{{ device.thermal }}°C</strong>
                </div>
                <div class="device-info-link">
                  <a href="#">Device Information &rarr;</a>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts_extra %}
  <!-- Archivo JS para las gráficas -->
  <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
{% endblock %}
